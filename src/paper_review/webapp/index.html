<!doctype html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>paper_review</title>
    <link rel="stylesheet" href="/static/styles.css" />
  </head>
  <body>
    <header class="topbar">
      <div class="brand">
        <div class="brand-name">paper_review</div>
        <div class="brand-sub muted">personal paper review dashboard</div>
      </div>
      <div class="spacer"></div>
      <button id="themeToggle" class="btn btn-ghost" type="button">Dark</button>
      <button id="logoutBtn" class="btn btn-secondary hidden" type="button">Logout</button>
    </header>

    <main class="container">
      <section id="loginSection" class="card hidden">
        <h1 class="h1">Sign in</h1>
        <p class="muted">내 개인용 paper review 대시보드</p>
        <div class="grid-2">
          <label class="field">
            <span class="label">Username</span>
            <input id="username" type="text" autocomplete="username" />
          </label>
          <label class="field">
            <span class="label">Password</span>
            <input id="password" type="password" autocomplete="current-password" />
          </label>
        </div>
        <div class="row">
          <button id="loginBtn" class="btn btn-primary" type="button">Login</button>
          <span id="loginError" class="error"></span>
        </div>
      </section>

      <section id="appSection" class="hidden">
        <section class="layout">
          <aside class="sidebar">
            <section class="card">
              <div class="row space-between">
                <h2 class="h2">New paper</h2>
                <span class="pill pill-muted">Choose one source</span>
              </div>

              <label class="field">
                <span class="label">PDF upload</span>
                <input id="pdfFile" type="file" accept="application/pdf" />
                <span class="hint">로컬 PDF를 바로 업로드해서 테스트할 수 있어요.</span>
              </label>

              <label class="field">
                <span class="label">Google Drive file id</span>
                <input id="driveFileId" type="text" placeholder="1ALi..." />
                <span class="hint">Drive에 이미 있는 PDF면 file id만 넣어도 됩니다.</span>
              </label>

              <div class="grid-2">
                <label class="field">
                  <span class="label">DOI</span>
                  <input id="doi" type="text" placeholder="10.1145/..." />
                </label>

                <label class="field">
                  <span class="label">Title (optional)</span>
                  <input id="title" type="text" placeholder="paper title..." />
                </label>
              </div>

              <label class="field">
                <span class="label">Analysis JSON upload</span>
                <input id="analysisJsonFile" type="file" accept="application/json,.json" />
                <span class="hint">
                  ChatGPT 웹에서 받은 분석 JSON을 업로드하면, API analyze 없이 바로 결과를 등록해요.
                </span>
              </label>

              <details id="analysisJsonPaste" class="accordion">
                <summary>Paste analysis JSON</summary>
                <textarea
                  id="analysisJsonText"
                  class="textarea"
                  rows="8"
                  spellcheck="false"
                  placeholder='{"paper": {...}, "normalized": {...}, "personas": [...], ...}'
                ></textarea>
                <div class="row">
                  <button id="analysisJsonClearBtn" class="btn btn-secondary btn-small" type="button">
                    Clear
                  </button>
                </div>
              </details>

              <div class="row">
                <button id="createBtn" class="btn btn-primary" type="button">Create</button>
                <span id="createStatus" class="muted"></span>
              </div>
              <p class="muted small">최소 하나는 필요: PDF / Drive file id / DOI / Analysis JSON</p>
            </section>

            <section class="card">
              <div class="row space-between">
                <h2 class="h2">Library</h2>
                <button id="refreshBtn" class="btn btn-secondary" type="button">Refresh</button>
              </div>

              <label class="field">
                <span class="label">Search</span>
                <input id="paperSearch" type="text" placeholder="title / doi / id" />
              </label>
              <div id="paperCount" class="muted small"></div>

              <div id="papersList" class="list"></div>
            </section>
          </aside>

          <section class="content">
            <section class="card details">
              <div class="row space-between">
                <h2 class="h2">Details</h2>
                <div class="row">
                  <button id="analyzeBtn" class="btn btn-primary" type="button" disabled>Analyze</button>
                  <button id="importJsonBtn" class="btn btn-secondary" type="button" disabled>
                    Import JSON
                  </button>
                  <button id="stopPollBtn" class="btn btn-secondary hidden" type="button">
                    Stop polling
                  </button>
                </div>
              </div>

              <div id="detailMeta" class="muted"></div>
              <div id="detailError" class="error"></div>
              <input id="importJsonFile" class="hidden" type="file" accept="application/json,.json" />
              <div id="importJsonStatus" class="muted"></div>

              <details id="importJsonPaste" class="accordion">
                <summary>Paste analysis JSON (import)</summary>
                <textarea
                  id="importJsonText"
                  class="textarea"
                  rows="8"
                  spellcheck="false"
                  placeholder='{"paper": {...}, "normalized": {...}, "personas": [...], ...}'
                ></textarea>
                <div class="row">
                  <button id="importJsonTextBtn" class="btn btn-secondary" type="button" disabled>
                    Import pasted JSON
                  </button>
                  <button id="importJsonClearBtn" class="btn btn-secondary btn-small" type="button">
                    Clear
                  </button>
                </div>
              </details>

              <div id="detailTabs" class="tabs" data-tabs="details">
                <button class="tab active" type="button" data-tab="overview">Overview</button>
                <button class="tab" type="button" data-tab="personas">Personas</button>
                <button class="tab" type="button" data-tab="normalized">Normalized</button>
                <button class="tab" type="button" data-tab="diagnostics">Diagnostics</button>
                <button class="tab" type="button" data-tab="md">Markdown</button>
                <button class="tab" type="button" data-tab="json">JSON</button>
              </div>

              <div id="overviewView" class="panel"></div>

              <div id="personasView" class="panel hidden">
                <div id="personaTabs" class="tabs tabs-sub"></div>
                <div id="personaContent" class="panel-body"></div>
              </div>

              <div id="normalizedView" class="panel hidden">
                <div id="normalizedTabs" class="tabs tabs-sub"></div>
                <div id="normalizedContent" class="panel-body"></div>
              </div>

              <div id="diagnosticsView" class="panel hidden"></div>

              <pre id="mdView" class="pre hidden"></pre>
              <pre id="jsonView" class="pre hidden"></pre>
            </section>
          </section>
        </section>
      </section>
    </main>

    <div id="toastHost" class="toasts" aria-live="polite" aria-atomic="true"></div>

    <script src="/static/app.js"></script>
  </body>
</html>
