# Copy to `.env` and fill values. Keep secrets out of git.

# Postgres (local)
DATABASE_URL=postgresql+psycopg2://postgres:postgres@localhost:5432/paper_review

# Supabase (recommended: Pooler / IPv4)
# DATABASE_URL=postgresql+psycopg2://postgres.<project_ref>:<password>@aws-0-<region>.pooler.supabase.com:6543/postgres?sslmode=require

# OpenAI
OPENAI_API_KEY=
OPENAI_MODEL=gpt-4.1-mini
OPENAI_DELETE_FILES=true
OPENAI_TIMEOUT_SECONDS=600

# Google AI (Gemini) (used when LLM provider is `google`)
GOOGLE_AI_API_KEY=
GOOGLE_AI_MODEL=gemini-1.5-flash
GOOGLE_AI_TIMEOUT_SECONDS=120
# If Gemini output is truncated (finishReason=MAX_TOKENS), increase this.
GOOGLE_AI_MAX_OUTPUT_TOKENS=30000
# Translation tone for Korean output (JSON/recommendations/Discord)

# Embeddings (OpenAI only)
EMBEDDINGS_NORMALIZE=true

# OpenAI embeddings
OPENAI_EMBED_MODEL=text-embedding-3-large
OPENAI_EMBED_BATCH_SIZE=96

# Local recommender pipeline (runs on your machine, uploads results to server)
SERVER_BASE_URL=http://127.0.0.1:8000
# SERVER_API_KEY= (defaults to API_KEY if set)
RECOMMENDER_QUERY_LLM_PROVIDER=ollama
RECOMMENDER_DECIDER_LLM_PROVIDER=openai
# - Providers: `ollama` (local), `openai`, `google`
RECOMMENDER_AUTO_RUN=false
RECOMMENDER_AUTO_RUN_TIME=06:00

# Local LLM (Ollama recommended)
OLLAMA_BASE_URL=http://127.0.0.1:11434
OLLAMA_TIMEOUT_SECONDS=120

# Model name in Ollama (e.g., `gpt-oss-20b`)
LOCAL_LLM_MODEL=gpt-oss-20b

# Generation options (shared across local backends)
LOCAL_LLM_MAX_NEW_TOKENS=256
LOCAL_LLM_TEMPERATURE=0.2
LOCAL_LLM_TOP_P=0.95

# Google Drive (pick ONE approach)
# (A) OAuth refresh token (recommended for personal Drive)
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=
GOOGLE_REFRESH_TOKEN=

# (B) Service account (recommended for Shared Drive / team)
# GOOGLE_SERVICE_ACCOUNT_FILE=./secrets/google-service-account.json

# Drive API scope
# - readonly (download only): https://www.googleapis.com/auth/drive.readonly
# - read+write (upload+download): https://www.googleapis.com/auth/drive
GOOGLE_DRIVE_SCOPE=https://www.googleapis.com/auth/drive.readonly

# Optional: Drive upload destination folder
# - If GOOGLE_DRIVE_UPLOAD_FOLDER_ID is set, uploads go there.
# - Otherwise, GOOGLE_DRIVE_UPLOAD_FOLDER_NAME is used (auto find/create).
GOOGLE_DRIVE_UPLOAD_FOLDER_NAME=Paper-Review
GOOGLE_DRIVE_UPLOAD_FOLDER_ID=

# Optional: Semantic Scholar (rate limits vary)
SEMANTIC_SCHOLAR_API_KEY=

# Optional: protect API endpoints
API_KEY=

# Web UI login (recommended for Cloud deploy)
# If WEB_USERNAME/WEB_PASSWORD are set, SESSION_SECRET is required.
WEB_USERNAME=
WEB_PASSWORD=
SESSION_SECRET=
COOKIE_HTTPS_ONLY=false

# Local PDF upload storage (used by /api/papers/upload)
UPLOAD_DIR=./data/uploads
UPLOAD_BACKEND=local

# Worker
WORKER_POLL_SECONDS=3
MAX_PDF_MB=50

# Discord
# - To RECEIVE messages (role mentions), you need a bot token (webhooks can't receive).
# - To SEND persona replies + notifications, set DISCORD_WEBHOOK_URL (existing webhook URL).
DISCORD_BOT_TOKEN=
DISCORD_WEBHOOK_URL=
# Optional restrictions (comma-separated ids)
DISCORD_ALLOWED_USER_IDS=
DISCORD_ALLOWED_GUILD_IDS=

# Personas (role mentions -> persona)
# Option A (recommended): JSON config (1-line JSON)
# DISCORD_PERSONAS_JSON=[{"key":"hikari","display_name":"히카리","role_id":123,"prompt_path":"docs/personas/hikari.md"},{"key":"rei","display_name":"레이","role_id":456,"prompt_path":"docs/personas/rei.md"},{"key":"tsugumi","display_name":"츠구미","role_id":789,"prompt_path":"docs/personas/tsugumi.md"}]
# DISCORD_PERSONA_DEFAULT_LLM_PROVIDER=openai  # openai|google|ollama
DISCORD_PERSONA_DEFAULT_LLM_PROVIDER=openai
DISCORD_PERSONA_HIKARI_ROLE_ID=1450894228736446636
DISCORD_PERSONA_HIKARI_AVATAR_URL=
DISCORD_PERSONA_REI_ROLE_ID=1450895298644676700
DISCORD_PERSONA_REI_AVATAR_URL=
DISCORD_PERSONA_TSUGUMI_ROLE_ID=
DISCORD_PERSONA_TSUGUMI_AVATAR_URL=

# Debate (thread-only, Hikari<->Rei with Tsugumi moderation every 3 turns)
DISCORD_DEBATE_ENABLED=true
DISCORD_DEBATE_POLL_SECONDS=15
DISCORD_DEBATE_MIN_INTERVAL_SECONDS=300
DISCORD_DEBATE_MAX_INTERVAL_SECONDS=600
DISCORD_DEBATE_MAX_TURNS_PER_THREAD=200
# Optional: attach Semantic Scholar search snippets to debate turns (can hit rate limits)
DISCORD_DEBATE_SEMANTIC_SCHOLAR=false

# Notifications (e.g., recommender finished)
DISCORD_NOTIFY_RECOMMENDER=false
# DISCORD_NOTIFY_WEBHOOK_URL= (if unset, falls back to DISCORD_WEBHOOK_URL)
DISCORD_NOTIFY_USERNAME=paper_review
DISCORD_NOTIFY_AVATAR_URL=
